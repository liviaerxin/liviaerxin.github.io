"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[3619],{27521:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>r,contentTitle:()=>t,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"how-to/how-to-vcpkg","title":"Getting Started with vcpkg","description":"Getting Started with vcpkg","source":"@site/../../docs/how-to/how-to-vcpkg.mdx","sourceDirName":"how-to","slug":"/how-to/how-to-vcpkg","permalink":"/docs/how-to/how-to-vcpkg","draft":false,"unlisted":false,"editUrl":"https://github.com/liviaerxin/liviaerxin.github.io/edit/master/_ssg/docusaurus/../../docs/how-to/how-to-vcpkg.mdx","tags":[{"inline":true,"label":"how-to","permalink":"/docs/tags/how-to"},{"inline":true,"label":"package","permalink":"/docs/tags/package"}],"version":"current","lastUpdatedBy":"liviaerxin","lastUpdatedAt":1746506890000,"frontMatter":{"sidebar_label":"how to vcpkg","description":"Getting Started with vcpkg","keywords":["how-to","vcpkg"],"image":"https://i.imgur.com/mErPwqL.png","tags":["how-to","package"],"date":"2023-06-23T00:00:00.000Z","author":"frank"},"sidebar":"docs","previous":{"title":"Playing with Unicode in deep","permalink":"/docs/how-to/how-to-unicode"},"next":{"title":"Inspect Shared Library","permalink":"/docs/how-to/inspect-shared-library"}}');var c=s(74848),l=s(28453);const a={sidebar_label:"how to vcpkg",description:"Getting Started with vcpkg",keywords:["how-to","vcpkg"],image:"https://i.imgur.com/mErPwqL.png",tags:["how-to","package"],date:new Date("2023-06-23T00:00:00.000Z"),author:"frank"},t="Getting Started with vcpkg",r={},o=[{value:"Classic mode",id:"classic-mode",level:2},{value:"Classic mode how-to",id:"classic-mode-how-to",level:3},{value:"Manifest mode",id:"manifest-mode",level:2},{value:"Manifest mode how-to",id:"manifest-mode-how-to",level:3},{value:"Useful environment variables for development",id:"useful-environment-variables-for-development",level:2},{value:"Tips and Tricks",id:"tips-and-tricks",level:2},{value:"How to specify a compiler fof <code>vcpkg install</code>?",id:"how-to-specify-a-compiler-fof-vcpkg-install",level:3},{value:"Install <code>*-osx-dynamic</code>",id:"install--osx-dynamic",level:3},{value:"Reinstall packages without caching",id:"reinstall-packages-without-caching",level:3},{value:"Clean up all packages",id:"clean-up-all-packages",level:3},{value:"Clean up all caching packages",id:"clean-up-all-caching-packages",level:3},{value:"<code>INSTALL_RPATH_USE_LINK_PATH</code> different behaviours in <strong>manifest mode</strong> and <strong>classic mode</strong>",id:"install_rpath_use_link_path-different-behaviours-in-manifest-mode-and-classic-mode",level:3},{value:"Resources",id:"resources",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,l.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.header,{children:(0,c.jsx)(n.h1,{id:"getting-started-with-vcpkg",children:"Getting Started with vcpkg"})}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"vcpkg"})," is cross-platform ",(0,c.jsx)(n.strong,{children:"C/C++ package manager"}),", and its peers include ",(0,c.jsx)(n.code,{children:"conan"}),"."]}),"\n",(0,c.jsx)(n.p,{children:"The most common type of package is a C/C++ library consisting of headers, source code, and binaries."}),"\n",(0,c.jsxs)(n.p,{children:["Some useful folders in ",(0,c.jsx)(n.code,{children:"VCPKG_ROOT=/path/to/vcpkg"})," in ",(0,c.jsx)(n.code,{children:"vcpkg"}),":"]}),"\n",(0,c.jsxs)(n.p,{children:["How ",(0,c.jsx)(n.code,{children:"vcpkg"})," install ",(0,c.jsx)(n.code,{children:"fmt"})," library when calling ",(0,c.jsx)(n.code,{children:"vcpkg install fmt"})," in classic mode?"]}),"\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsxs)(n.li,{children:["Download the source code ",(0,c.jsx)(n.code,{children:"fmt.tar.gz"})," into ",(0,c.jsx)(n.code,{children:"%VCPKG_ROOT%/downloads/"})," directory."]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"build tree"})," -> ",(0,c.jsx)(n.code,{children:"%VCPKG_ROOT%/buildtrees"}),":","\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsxs)(n.li,{children:["Put the source code under ",(0,c.jsx)(n.code,{children:"%VCPKG_ROOT%/buildtrees/fmt/src/xxxx-xxxx.clean/"})," directory."]}),"\n",(0,c.jsxs)(n.li,{children:["Create building directory: ",(0,c.jsx)(n.code,{children:"%VCPKG_ROOT%/buildtrees/fmt/arm64-osx-dynamic-rel/"}),"(",(0,c.jsx)(n.code,{children:"triplet"}),"+",(0,c.jsx)(n.code,{children:"release/debug"}),") and then start building"]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"package tree"})," -> ",(0,c.jsx)(n.code,{children:"%VCPKG_ROOT%/package"}),":","\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsxs)(n.li,{children:["Package ",(0,c.jsx)(n.code,{children:"fmt"})," built library like ",(0,c.jsx)(n.code,{children:"fmt.dylib"}),", its ",(0,c.jsx)(n.code,{children:"header"})," files and ",(0,c.jsx)(n.code,{children:"binaries"}),"(tools) in ",(0,c.jsx)(n.strong,{children:"build tree"})," into ",(0,c.jsx)(n.code,{children:"%VCPKG_ROOT%/packages/fmt_arm64-osx-dynamic/"})]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"install tree"})," -> ",(0,c.jsx)(n.code,{children:"%VCPKG_ROOT%/installed"}),":","\n",(0,c.jsxs)(n.ol,{children:["\n",(0,c.jsxs)(n.li,{children:["Install ",(0,c.jsx)(n.code,{children:"fmt"}),"'s ",(0,c.jsx)(n.code,{children:"libs"}),", ",(0,c.jsx)(n.code,{children:"headers"})," and ",(0,c.jsx)(n.code,{children:"tools"})," in ",(0,c.jsx)(n.strong,{children:"package tree"})," into ",(0,c.jsx)(n.code,{children:"%VCPKG_ROOT%/installed/arm64-osx-dynamic/lib"}),", ",(0,c.jsx)(n.code,{children:"%VCPKG_ROOT%/installed/arm64-osx-dynamic/include"})," and ",(0,c.jsx)(n.code,{children:"%VCPKG_ROOT%/installed/arm64-osx-dynamic/tools"})," respectively."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:["As it outlines, ",(0,c.jsx)(n.code,{children:"vcpkg"})," builds each package separately in ",(0,c.jsx)(n.strong,{children:"build tree"})," and ",(0,c.jsx)(n.strong,{children:"package tree"})," stages and finally in ",(0,c.jsx)(n.strong,{children:"install tree"})," stage ",(0,c.jsx)(n.code,{children:"reduce"})," all packages into the central set in ",(0,c.jsx)(n.code,{children:"%VCPKG_ROOT%/installed/arm64-osx-dynamic/"}),"."]}),"\n",(0,c.jsx)(n.h2,{id:"classic-mode",children:"Classic mode"}),"\n",(0,c.jsxs)(n.p,{children:["Official saying: In Classic mode, vcpkg maintains a central ",(0,c.jsx)(n.strong,{children:"installed tree"})," inside the vcpkg instance built up by individual ",(0,c.jsx)(n.code,{children:"vcpkg install"})," and ",(0,c.jsx)(n.code,{children:"vcpkg remove"})," commands. This central set of packages can then be shared by any number of projects."]}),"\n",(0,c.jsxs)(n.p,{children:["All packages are installed in a common ",(0,c.jsx)(n.code,{children:"%VCPKG_ROOT%/installed"})," directory."]}),"\n",(0,c.jsx)(n.h3,{id:"classic-mode-how-to",children:"Classic mode how-to"}),"\n",(0,c.jsxs)(n.p,{children:["Just run ",(0,c.jsx)(n.code,{children:"vcpkg install %package%"})," to use ",(0,c.jsx)(n.strong,{children:"classic mode"})," as the package will be installed into ",(0,c.jsx)(n.code,{children:"%VCPKG_ROOT%/installed/"}),"."]}),"\n",(0,c.jsx)(n.h2,{id:"manifest-mode",children:"Manifest mode"}),"\n",(0,c.jsxs)(n.p,{children:["Official saying: In Manifest mode, vcpkg creates separate ",(0,c.jsx)(n.strong,{children:"installed trees"})," for each project and configuration. This allows separate projects to use different versions of libraries. The ",(0,c.jsx)(n.code,{children:"vcpkg.json"})," file and optional ",(0,c.jsx)(n.code,{children:"vcpkg-configuration.json"})," file form a project's manifest. The manifest declares the project's direct dependencies, version constraints, and registries used."]}),"\n",(0,c.jsxs)(n.p,{children:["All packages are installed in their own ",(0,c.jsx)(n.code,{children:"${project}/vcpkg_installed"})," directory inside the ",(0,c.jsx)(n.code,{children:"${project}"})," directory."]}),"\n",(0,c.jsx)(n.h3,{id:"manifest-mode-how-to",children:"Manifest mode how-to"}),"\n",(0,c.jsxs)(n.p,{children:["Create ",(0,c.jsx)(n.code,{children:"vcpkg.json"})," in the project, then run ",(0,c.jsx)(n.code,{children:"vcpkg install"})," to use ",(0,c.jsx)(n.strong,{children:"manifest mode"})," as all the packages declared in ",(0,c.jsx)(n.code,{children:"vcpkg.json"})," will be installed into ",(0,c.jsx)(n.code,{children:"${project}/vcpkg_installed/"}),"."]}),"\n",(0,c.jsx)(n.h2,{id:"useful-environment-variables-for-development",children:"Useful environment variables for development"}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"CURRENT_INSTALLED_DIR"}),"\n",(0,c.jsx)(n.code,{children:"CURRENT_PACKAGES_DIR"})]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-sh",children:'set(VCPKG_RELEASE_LIBDIR "${CURRENT_INSTALLED_DIR}/lib")\nset(VCPKG_DEBUG_LIBDIR "${CURRENT_INSTALLED_DIR}/debug/lib")\nset(VCPKG_TOOLS_DIR "${CURRENT_INSTALLED_DIR}/tools")\nset(VCPKG_SHARE_DIR "${CURRENT_INSTALLED_DIR}/share")\nset(VCPKG_INCLUDE_DIR "${CURRENT_INSTALLED_DIR}/include")\n'})}),"\n",(0,c.jsx)(n.h2,{id:"tips-and-tricks",children:"Tips and Tricks"}),"\n",(0,c.jsxs)(n.h3,{id:"how-to-specify-a-compiler-fof-vcpkg-install",children:["How to specify a compiler fof ",(0,c.jsx)(n.code,{children:"vcpkg install"}),"?"]}),"\n",(0,c.jsxs)(n.p,{children:["As ",(0,c.jsx)(n.code,{children:"vcpkg"})," just use ",(0,c.jsx)(n.code,{children:"cmake"})," toolchain to do install, how to set a specific compile is ",(0,c.jsx)(n.code,{children:"cmake"})," things."]}),"\n",(0,c.jsxs)(n.p,{children:["A fast way is use ",(0,c.jsx)(n.code,{children:"CC"})," and ",(0,c.jsx)(n.code,{children:"CXX"})," environment variables."]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-sh",children:"export CC=gcc-4.2\nexport CXX=/usr/bin/g++-4.2\n"})}),"\n",(0,c.jsxs)(n.p,{children:["See more ways at ",(0,c.jsx)(n.a,{href:"https://stackoverflow.com/questions/45933732/how-to-specify-a-compiler-in-cmake",children:"iar - How to specify a compiler in CMake? - Stack Overflow"})]}),"\n",(0,c.jsxs)(n.h3,{id:"install--osx-dynamic",children:["Install ",(0,c.jsx)(n.code,{children:"*-osx-dynamic"})]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-sh",children:"vcpkg install libpq --host-triplet=arm64-osx-dynamic --triplet=arm64-osx-dynamic\n"})}),"\n",(0,c.jsx)(n.h3,{id:"reinstall-packages-without-caching",children:"Reinstall packages without caching"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-sh",children:'vcpkg remove icu --host-triplet=arm64-osx-dynamic --triplet=arm64-osx-dynamic\nvcpkg install icu --host-triplet=arm64-osx-dynamic --triplet=arm64-osx-dynamic --no-binarycaching\nvcpkg install libpq --host-triplet=arm64-osx-dynamic --triplet=arm64-osx-dynamic --binarysource=clear\nvcpkg remove libpq --host-triplet=arm64-osx-dynamic --triplet=arm64-osx-dynamic\n\nvcpkg remove "qtbase[gui,widgets]" --host-triplet=arm64-osx-dynamic --triplet=arm64-osx-dynamic\nvcpkg install "qtbase[gui,widgets]" --host-triplet=arm64-osx-dynamic --triplet=arm64-osx-dynamic --no-binarycaching\nvcpkg install "qtbase[gui,widgets]" --host-triplet=arm64-osx-dynamic --triplet=arm64-osx-dynamic --binarysource=clear\n'})}),"\n",(0,c.jsx)(n.h3,{id:"clean-up-all-packages",children:"Clean up all packages"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-sh",children:"rm -rf /opt/vcpkg/installed/\nrm -rf /opt/vcpkg/packages/\nrm -rf /opt/vcpkg/buildtrees/\n"})}),"\n",(0,c.jsx)(n.h3,{id:"clean-up-all-caching-packages",children:"Clean up all caching packages"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-sh",children:"rm -rf ~/.cache/vcpkg/archives/\n"})}),"\n",(0,c.jsxs)(n.h3,{id:"install_rpath_use_link_path-different-behaviours-in-manifest-mode-and-classic-mode",children:[(0,c.jsx)(n.code,{children:"INSTALL_RPATH_USE_LINK_PATH"})," different behaviours in ",(0,c.jsx)(n.strong,{children:"manifest mode"})," and ",(0,c.jsx)(n.strong,{children:"classic mode"})]}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"INSTALL_RPATH_USE_LINK_PATH"})," will not work properly when being used in the ",(0,c.jsx)(n.strong,{children:"manifest mode"}),", because ",(0,c.jsx)(n.code,{children:"CMake"})," will don't handle libraries located in ",(0,c.jsx)(n.code,{children:"buildtree"}),":"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-sh",children:'set_target_properties(${PROJECT_NAME} PROPERTIES\n    INSTALL_RPATH "@executable_path/../Frameworks"\n    INSTALL_RPATH_USE_LINK_PATH ON\n)\n'})}),"\n",(0,c.jsxs)(n.p,{children:["After ",(0,c.jsx)(n.code,{children:"${PROJECT_NAME}"})," installed, in the ",(0,c.jsx)(n.strong,{children:"manifest mode"}),":"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-sh",children:"\u276f otoolll /Users/frankchen/Documents/vcpkg-qt-app/install/./helloworld.app/Contents/MacOS/helloworld\n          cmd LC_RPATH\n      cmdsize 48\n         path @executable_path/../Frameworks (offset 12)\n"})}),"\n",(0,c.jsxs)(n.p,{children:["After ",(0,c.jsx)(n.code,{children:"${PROJECT_NAME}"})," installed, in the ",(0,c.jsx)(n.strong,{children:"classic mode"}),":"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-sh",children:"\u276f otoolll /Users/frankchen/Documents/vcpkg-qt-app/install/./helloworld.app/Contents/MacOS/helloworld\n          cmd LC_RPATH\n      cmdsize 56\n         path /opt/vcpkg/installed/arm64-osx-dynamic/lib (offset 12)\nLoad command 27\n      cmd LC_FUNCTION_STARTS\n--\n          cmd LC_RPATH\n      cmdsize 48\n         path @executable_path/../Frameworks (offset 12)\n"})}),"\n",(0,c.jsx)(n.p,{children:"[wiki-cmake.mdx#RPATH in CMake](./wiki-cmake.mdx#RPATH in CMake)"}),"\n",(0,c.jsx)(n.h2,{id:"resources",children:"Resources"}),"\n",(0,c.jsx)(n.p,{children:"TODO: Fix qtbase tools/config in release/debug osx"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.a,{href:"https://github.com/microsoft/vcpkg/tree/master/ports/qtbase",children:"https://github.com/microsoft/vcpkg/tree/master/ports/qtbase"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/vcpkg/maintainers/functions/vcpkg_cmake_config_fixup",children:"https://learn.microsoft.com/en-us/vcpkg/maintainers/functions/vcpkg_cmake_config_fixup"})})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(d,{...e})}):d(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>t});var i=s(96540);const c={},l=i.createContext(c);function a(e){const n=i.useContext(l);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:a(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);