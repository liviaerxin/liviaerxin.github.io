"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[7887],{62432:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>s,default:()=>h,frontMatter:()=>r,metadata:()=>c,toc:()=>o});var l=i(74848),a=i(28453);const r={sidebar_label:"Learn CMake",description:"Learn CMake",keywords:["cmake","project structure"],image:"https://i.imgur.com/mErPwqL.png",tags:["cmake","wiki"],date:new Date("2023-06-25T00:00:00.000Z"),author:"frank"},s="Learn CMake",c={id:"wiki-cmake",title:"Learn CMake",description:"Learn CMake",source:"@site/../../docs/wiki-cmake.mdx",sourceDirName:".",slug:"/wiki-cmake",permalink:"/docs/wiki-cmake",draft:!1,unlisted:!1,editUrl:"https://github.com/liviaerxin/liviaerxin.github.io/edit/master/_ssg/docusaurus/../../docs/wiki-cmake.mdx",tags:[{inline:!0,label:"cmake",permalink:"/docs/tags/cmake"},{inline:!0,label:"wiki",permalink:"/docs/tags/wiki"}],version:"current",lastUpdatedBy:"liviaerxin",lastUpdatedAt:1744922238e3,frontMatter:{sidebar_label:"Learn CMake",description:"Learn CMake",keywords:["cmake","project structure"],image:"https://i.imgur.com/mErPwqL.png",tags:["cmake","wiki"],date:"2023-06-25T00:00:00.000Z",author:"frank"},sidebar:"docs",previous:{title:"Wiki Avalonia",permalink:"/docs/wiki-avalonia"},next:{title:"Wiki Compiler",permalink:"/docs/wiki-compiler"}},d={},o=[{value:"CMake Project Structure",id:"cmake-project-structure",level:2},{value:"How CMake Works",id:"how-cmake-works",level:2},{value:"How to make your package be found by others by <code>find_package()</code>",id:"how-to-make-your-package-be-found-by-others-by-find_package",level:2},{value:"RPATH in CMake",id:"rpath-in-cmake",level:2},{value:"CMake Variables",id:"cmake-variables",level:2},{value:"<code>clang</code> FAQ",id:"clang-faq",level:2},{value:"Find out <code>clang</code> include search path",id:"find-out-clang-include-search-path",level:3},{value:"Add include search path to <code>clang</code>",id:"add-include-search-path-to-clang",level:3},{value:"Find out <code>clang</code> library search paths",id:"find-out-clang-library-search-paths",level:3},{value:"Add library search path to <code>clang</code>",id:"add-library-search-path-to-clang",level:3},{value:"What is the difference? clang++ | clang -std=c++11",id:"what-is-the-difference-clang--clang--stdc11",level:2},{value:"CMake FAQ",id:"cmake-faq",level:2},{value:"Add library search path to <code>CMake</code> globally in project",id:"add-library-search-path-to-cmake-globally-in-project",level:3},{value:"Resources",id:"resources",level:2}];function t(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",section:"section",strong:"strong",sup:"sup",...(0,a.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.h1,{id:"learn-cmake",children:"Learn CMake"}),"\n",(0,l.jsxs)(n.p,{children:["In brief, ",(0,l.jsx)(n.strong,{children:"CMake"})," is all about ",(0,l.jsx)(n.strong,{children:"targets"})," and ",(0,l.jsx)(n.strong,{children:"properties"})]}),"\n",(0,l.jsx)(n.h2,{id:"cmake-project-structure",children:"CMake Project Structure"}),"\n",(0,l.jsxs)(n.p,{children:["A typical ",(0,l.jsx)(n.strong,{children:"CMake"})," project can be regarded to has three ",(0,l.jsx)(n.code,{children:"Tree"}),":"]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Source Tree"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sh",children:"project_root\n\u251c\u2500\u2500 CMakeLists.txt\n\u251c\u2500\u2500 simple_example.cpp\n\u251c\u2500\u2500 simple_lib.cpp\n\u2514\u2500\u2500 simple_lib.hpp\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Build Tree"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sh",children:"project_root\n\u251c\u2500\u2500 CMakeLists.txt\n\u251c\u2500\u2500 simple_example.cpp\n\u251c\u2500\u2500 simple_lib.cpp\n\u251c\u2500\u2500 simple_lib.hpp\n\u2514\u2500\u2500 build\n    \u2514\u2500\u2500 CMakeCache.txt\n"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Install Tree"}),":"]}),"\n",(0,l.jsxs)(n.p,{children:["This tree is located in the ",(0,l.jsx)(n.code,{children:"CMAKE_INSTALL_PREFIX"}),", of which default value is platform-dependent. By default, it is set to ",(0,l.jsx)(n.code,{children:"/usr/local"})," on Unix-like systems (Linux, macOS) and ",(0,l.jsx)(n.code,{children:"C:/Program Files/<Project Name>"})," on Windows.."]}),"\n",(0,l.jsxs)(n.p,{children:["To change it, you can pass ",(0,l.jsx)(n.code,{children:"-DCMAKE_INSTALL_PREFIX"})," argument during CMake ",(0,l.jsx)(n.code,{children:"configuration"})," step, like this:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sh",children:"cmake -B build -S . -DCMAKE_INSTALL_PREFIX=/my/custom/installation/path\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Alternatively, you can change it by passing ",(0,l.jsx)(n.code,{children:"--prefix"}),"(it can be relative path) argument during CMake ",(0,l.jsx)(n.code,{children:"install"})," step, like this:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sh",children:'cmake --install build --prefix "/my/custom/installation/path"\n'})}),"\n",(0,l.jsxs)(n.p,{children:["It's recommended to use a default install layout as ",(0,l.jsx)(n.code,{children:"GNUInstallDirs"}),"."]}),"\n",(0,l.jsxs)(n.p,{children:["A ",(0,l.jsx)(n.strong,{children:"install tree"})," will look like as below if you'd like all things to be installed inside the project via ",(0,l.jsx)(n.code,{children:'cmake --install build --prefix "./install'}),"."]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sh",children:"project_root\n\u251c\u2500\u2500 CMakeLists.txt\n\u251c\u2500\u2500 simple_example.cpp\n\u251c\u2500\u2500 simple_lib.cpp\n\u251c\u2500\u2500 simple_lib.hpp\n\u251c\u2500\u2500 build\n\u2502   \u2514\u2500\u2500 CMakeCache.txt\n\u2514\u2500\u2500 install\n    \u251c\u2500\u2500 bin\n    \u2502   \u2514\u2500\u2500 executables\n    \u251c\u2500\u2500 sbin\n    \u2502   \u2514\u2500\u2500 sysadmin executables\n    \u251c\u2500\u2500 lib\n    \u2502   \u251c\u2500\u2500 compiled libraries (*.so (unix) or *.dll (windows))\n    \u2502   \u2514\u2500\u2500 library archive files (*.lib (windows))\n    \u251c\u2500\u2500 libexec\n    \u2502   \u2514\u2500\u2500 executables not directly invoked by user\n    \u251c\u2500\u2500 include\n    \u2502   \u2514\u2500\u2500 header files\n    \u2514\u2500\u2500 doc\n       \u2514\u2500\u2500 documentation\n"})}),"\n",(0,l.jsx)(n.h2,{id:"how-cmake-works",children:"How CMake Works"}),"\n",(0,l.jsxs)(n.p,{children:["A typical workflow of CMake includes ",(0,l.jsx)(n.code,{children:"Configure"}),", ",(0,l.jsx)(n.code,{children:"Build"})," and ",(0,l.jsx)(n.code,{children:"Install"})," steps, combined with the above mentioned ",(0,l.jsx)(n.code,{children:"Trees"})," concepts."]}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"Configure"})," step will generate a sort of configuration files, the most important ones among them are ",(0,l.jsx)(n.code,{children:"CMakeCache.txt"}),", ",(0,l.jsx)(n.code,{children:"cmake_install.cmake"})," and ",(0,l.jsx)(n.code,{children:"Makefile"})," if using ",(0,l.jsx)(n.code,{children:"Make"})," as building system. With these generated configuration files, the later steps ",(0,l.jsx)(n.code,{children:"Build"})," and ",(0,l.jsx)(n.code,{children:"Install"})," will run according to them."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"Build"})," step will generate the build binary directory."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"Install"})," step will generate the install binary directory."]}),"\n"]}),"\n",(0,l.jsxs)(n.h2,{id:"how-to-make-your-package-be-found-by-others-by-find_package",children:["How to make your package be found by others by ",(0,l.jsx)(n.code,{children:"find_package()"})]}),"\n",(0,l.jsxs)(n.p,{children:["package configuration files: ",(0,l.jsx)(n.code,{children:"find_package"})]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.a,{href:"https://cmake.org/cmake/help/latest/guide/importing-exporting/index.html#importing-targets",children:"Title"})}),"\n",(0,l.jsx)(n.h2,{id:"rpath-in-cmake",children:"RPATH in CMake"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.sup,{children:(0,l.jsx)(n.a,{href:"#user-content-fn-rpath",id:"user-content-fnref-rpath","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"1"})})}),"\n",(0,l.jsx)(n.h2,{id:"cmake-variables",children:"CMake Variables"}),"\n",(0,l.jsx)(n.p,{children:"There are some useful and important CMake variables that will be introduced here:"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.code,{children:"CMAKE_PREFIX_PATH"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.code,{children:"CMAKE_IGNORE_PATH"})}),"\n",(0,l.jsxs)(n.h2,{id:"clang-faq",children:[(0,l.jsx)(n.code,{children:"clang"})," FAQ"]}),"\n",(0,l.jsxs)(n.h3,{id:"find-out-clang-include-search-path",children:["Find out ",(0,l.jsx)(n.code,{children:"clang"})," include search path"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sh",children:'\u276f clang -x c -v -E /dev/null\n...\n#include "..." search starts here:\n#include <...> search starts here:\n /opt/homebrew/Cellar/llvm/17.0.1/lib/clang/17/include\n /Library/Developer/CommandLineTools/SDKs/MacOSX14.sdk/usr/include\n /Library/Developer/CommandLineTools/SDKs/MacOSX14.sdk/System/Library/Frameworks (framework directory)\nEnd of search list.\n# 1 "/dev/null"\n# 1 "<built-in>" 1\n# 1 "<built-in>" 3\n# 420 "<built-in>" 3\n# 1 "<command line>" 1\n# 1 "<built-in>" 2\n# 1 "/dev/null" 2\n'})}),"\n",(0,l.jsxs)(n.h3,{id:"add-include-search-path-to-clang",children:["Add include search path to ",(0,l.jsx)(n.code,{children:"clang"})]}),"\n",(0,l.jsxs)(n.p,{children:["Use environment variables ",(0,l.jsx)(n.code,{children:"C_INCLUDE_PATH"})," for ",(0,l.jsx)(n.code,{children:"c"})," and ",(0,l.jsx)(n.code,{children:"CPLUS_INCLUDE_PATH"})," for ",(0,l.jsx)(n.code,{children:"c++"}),"."]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"clang"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sh",children:'\u276f C_INCLUDE_PATH=/opt/homebrew/include clang -x c -v -E /dev/null\n...\n#include "..." search starts here:\n#include <...> search starts here:\n /usr/local/include\n /opt/homebrew/include\n /Library/Developer/CommandLineTools/usr/lib/clang/15.0.0/include\n /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/include\n /Library/Developer/CommandLineTools/usr/include\n /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/System/Library/Frameworks (framework directory)\n'})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"clang++"}),":"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sh",children:'\u276f CPLUS_INCLUDE_PATH=/opt/homebrew/include clang -x c++ -v -E /dev/null\n...\n#include "..." search starts here:\n#include <...> search starts here:\n /usr/local/include\n /opt/homebrew/include\n /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/include/c++/v1\n /Library/Developer/CommandLineTools/usr/lib/clang/15.0.0/include\n /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/include\n /Library/Developer/CommandLineTools/usr/include\n /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/System/Library/Frameworks (framework directory)\n'})}),"\n",(0,l.jsxs)(n.p,{children:["Use ",(0,l.jsx)(n.code,{children:"-I"})," flag,"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sh",children:'\u276f clang -x c -I/opt/homebrew/include -v -E /dev/null\n...\n#include "..." search starts here:\n#include <...> search starts here:\n /opt/homebrew/include\n /usr/local/include\n /Library/Developer/CommandLineTools/usr/lib/clang/15.0.0/include\n /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/usr/include\n /Library/Developer/CommandLineTools/usr/include\n /Library/Developer/CommandLineTools/SDKs/MacOSX.sdk/System/Library/Frameworks (framework directory)\n'})}),"\n",(0,l.jsxs)(n.h3,{id:"find-out-clang-library-search-paths",children:["Find out ",(0,l.jsx)(n.code,{children:"clang"})," library search paths"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sh",children:"\u276f clang -Xlinker -v\n...\nLibrary search paths:\n\t/usr/local/lib\nFramework search paths:\nld: Undefined symbols:\n  _main, referenced from:\n      <initial-undefines>\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\n"})}),"\n",(0,l.jsxs)(n.h3,{id:"add-library-search-path-to-clang",children:["Add library search path to ",(0,l.jsx)(n.code,{children:"clang"})]}),"\n",(0,l.jsxs)(n.p,{children:["Use environment variables ",(0,l.jsx)(n.code,{children:"LIBRARY_PATH"}),","]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sh",children:"\u276f LIBRARY_PATH=$LIBRARY_PATH:/usr/lib clang -Xlinker -v\n...\nLibrary search paths:\n\t.\n\t/usr/lib\n\t/usr/local/lib\nFramework search paths:\nld: Undefined symbols:\n  _main, referenced from:\n      <initial-undefines>\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\n"})}),"\n",(0,l.jsxs)(n.p,{children:["Use ",(0,l.jsx)(n.code,{children:"-L"})," flag:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-sh",children:"\u276f clang -L/opt/homebrew/lib -Xlinker -v\n"})}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.a,{href:"https://langui.sh/2015/07/24/osx-clang-include-lib-search-paths/",children:"https://langui.sh/2015/07/24/osx-clang-include-lib-search-paths/"})}),"\n",(0,l.jsx)(n.h2,{id:"what-is-the-difference-clang--clang--stdc11",children:"What is the difference? clang++ | clang -std=c++11"}),"\n",(0,l.jsx)(n.h2,{id:"cmake-faq",children:"CMake FAQ"}),"\n",(0,l.jsxs)(n.h3,{id:"add-library-search-path-to-cmake-globally-in-project",children:["Add library search path to ",(0,l.jsx)(n.code,{children:"CMake"})," globally in project"]}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"set(CMAKE_LIBRARY_PATH ${CMAKE_LIBRARY_PATH} /opt/local/lib)"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"LINK_DIRECTORIES(/opt/local/lib)"})}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"resources",children:"Resources"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.a,{href:"https://enccs.github.io/cmake-workshop/",children:"CMake hands-on workshop \u2014 CMake Workshop"})}),"\n","\n",(0,l.jsxs)(n.section,{"data-footnotes":!0,className:"footnotes",children:[(0,l.jsx)(n.h2,{className:"sr-only",id:"footnote-label",children:"Footnotes"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{id:"user-content-fn-rpath",children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.a,{href:"https://gitlab.kitware.com/cmake/community/-/wikis/doc/cmake/RPATH-handling",children:"RPATH handling from official cmake"})," ",(0,l.jsx)(n.a,{href:"#user-content-fnref-rpath","data-footnote-backref":"","aria-label":"Back to reference 1",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(t,{...e})}):t(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>c});var l=i(96540);const a={},r=l.createContext(a);function s(e){const n=l.useContext(r);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),l.createElement(r.Provider,{value:n},e.children)}}}]);