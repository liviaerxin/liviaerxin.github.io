"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[2615],{28453:(e,s,t)=>{t.d(s,{R:()=>i,x:()=>l});var r=t(96540);const d={},n=r.createContext(d);function i(e){const s=r.useContext(n);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:i(e.components),r.createElement(n.Provider,{value:s},e.children)}},85441:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>c,contentTitle:()=>l,default:()=>o,frontMatter:()=>i,metadata:()=>r,toc:()=>h});const r=JSON.parse('{"id":"cheat-sheet/cheatsheet-assembly-arm64","title":"ARM64/AArch64 Assembly Cheat Sheet","description":"Cheatsheet ARM64","source":"@site/../../docs/cheat-sheet/cheatsheet-assembly-arm64.mdx","sourceDirName":"cheat-sheet","slug":"/cheat-sheet/cheatsheet-assembly-arm64","permalink":"/docs/cheat-sheet/cheatsheet-assembly-arm64","draft":false,"unlisted":false,"editUrl":"https://github.com/liviaerxin/liviaerxin.github.io/edit/master/docs/../../docs/cheat-sheet/cheatsheet-assembly-arm64.mdx","tags":[{"inline":true,"label":"arm64","permalink":"/docs/tags/arm-64"},{"inline":true,"label":"aarch64","permalink":"/docs/tags/aarch-64"},{"inline":true,"label":"cheat sheet","permalink":"/docs/tags/cheat-sheet"}],"version":"current","lastUpdatedBy":"liviaerxin","lastUpdatedAt":1746815972000,"frontMatter":{"authors":["frank"],"tags":["arm64","aarch64","cheat sheet"],"description":"Cheatsheet ARM64","keywords":["AArch64","ARM64","Cheat sheet"],"image":"https://i.imgur.com/mErPwqL.png","date":"2024-01-14T00:00:00.000Z","draft":false,"enableComments":true},"sidebar":"docs","previous":{"title":"Cheat Sheet","permalink":"/docs/category/cheat-sheet"},"next":{"title":"x64 Assembly Cheat Sheet","permalink":"/docs/cheat-sheet/cheatsheet-assembly-x64"}}');var d=t(74848),n=t(28453);const i={authors:["frank"],tags:["arm64","aarch64","cheat sheet"],description:"Cheatsheet ARM64",keywords:["AArch64","ARM64","Cheat sheet"],image:"https://i.imgur.com/mErPwqL.png",date:new Date("2024-01-14T00:00:00.000Z"),draft:!1,enableComments:!0},l="ARM64/AArch64 Assembly Cheat Sheet",c={},h=[{value:"Registers",id:"registers",level:2},{value:"Data type",id:"data-type",level:2},{value:"Load from immediate",id:"load-from-immediate",level:2},{value:"Load from label",id:"load-from-label",level:2},{value:"Store",id:"store",level:2},{value:"Resources",id:"resources",level:2}];function a(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,n.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(s.header,{children:(0,d.jsx)(s.h1,{id:"arm64aarch64-assembly-cheat-sheet",children:"ARM64/AArch64 Assembly Cheat Sheet"})}),"\n",(0,d.jsx)(s.h2,{id:"registers",children:"Registers"}),"\n",(0,d.jsxs)(s.table,{children:[(0,d.jsx)(s.thead,{children:(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.th,{children:"Register"}),(0,d.jsx)(s.th,{children:"Low 32-bits"}),(0,d.jsx)(s.th,{children:"Calling convention"})]})}),(0,d.jsxs)(s.tbody,{children:[(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"General-purpose registers:"}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"x0"})}),(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"w0"})}),(0,d.jsx)(s.td,{})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"x1"})}),(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"w1"})}),(0,d.jsx)(s.td,{})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"x2"})}),(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"w2"})}),(0,d.jsx)(s.td,{})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"Special-purpose registers:"}),(0,d.jsx)(s.td,{}),(0,d.jsx)(s.td,{})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"xzr"})}),(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"wzr"})}),(0,d.jsx)(s.td,{children:"Zero register"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"sp"})}),(0,d.jsx)(s.td,{children:"-"}),(0,d.jsx)(s.td,{children:"Stack pointer"})]})]})]}),"\n",(0,d.jsx)(s.h2,{id:"data-type",children:"Data type"}),"\n",(0,d.jsxs)(s.table,{children:[(0,d.jsx)(s.thead,{children:(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.th,{children:"Definition size"}),(0,d.jsx)(s.th,{children:"Definition instruction"})]})}),(0,d.jsxs)(s.tbody,{children:[(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"8 bit"}),(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"byte"})})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"16 bit"}),(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"hword"})})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"32 bit"}),(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"word"})})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:"64 bit"}),(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"dword"})})]})]})]}),"\n",(0,d.jsx)(s.h2,{id:"load-from-immediate",children:"Load from immediate"}),"\n",(0,d.jsxs)(s.p,{children:[(0,d.jsx)(s.code,{children:"movz"}),"/",(0,d.jsx)(s.code,{children:"mov"})," + ",(0,d.jsx)(s.code,{children:"movk"})]}),"\n",(0,d.jsxs)(s.p,{children:["Load the 64-bit integer ",(0,d.jsx)(s.code,{children:"0x1a2b3c4d1a2b3c4d"})," from the immediate,"]}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-asm",children:"// Load the 64-bit integer `0x1a2b3c4d1a2b3c4d` from the immediate\nmovz     x1, #0x3c4d\nmovk    x1, #0x1a2b, lsl #16\nmovk    x1, #0x3c4d, lsl #32\nmovk    x1, #0x1a2b, lsl #48\n"})}),"\n",(0,d.jsx)(s.h2,{id:"load-from-label",children:"Load from label"}),"\n",(0,d.jsxs)(s.table,{children:[(0,d.jsx)(s.thead,{children:(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.th,{children:"Load instruction"}),(0,d.jsx)(s.th,{children:"Purpose"})]})}),(0,d.jsxs)(s.tbody,{children:[(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"ldr    x0, [x1]"})}),(0,d.jsx)(s.td,{children:"load 64-bit"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"ldr    w0, [x1]"})}),(0,d.jsx)(s.td,{children:"load 32-bit"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"ldrh    w0, [x1]"})}),(0,d.jsx)(s.td,{children:"load 16-bit"})]}),(0,d.jsxs)(s.tr,{children:[(0,d.jsx)(s.td,{children:(0,d.jsx)(s.code,{children:"ldrb    w0, [x1]"})}),(0,d.jsx)(s.td,{children:"load 8-bit"})]})]})]}),"\n",(0,d.jsxs)(s.p,{children:["Assume the 32-bit data in ",(0,d.jsx)(s.code,{children:".data"})," section,"]}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-asm",children:".data\n    int32_var:  .word   0x1a2b3c4d\n"})}),"\n",(0,d.jsxs)(s.p,{children:[(0,d.jsx)(s.code,{children:"adr"}),": shift by byte(\xb11M, one instruction), the assembler will do:"]}),"\n",(0,d.jsxs)(s.ul,{children:["\n",(0,d.jsxs)(s.li,{children:["calculate the PC-relative offset from the current ",(0,d.jsx)(s.code,{children:"adr"})," instruction to the label ",(0,d.jsx)(s.code,{children:"int32_var"})," in bytes."]}),"\n",(0,d.jsxs)(s.li,{children:["encode the offset in the ",(0,d.jsx)(s.code,{children:"adr"})," instruction."]}),"\n"]}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-asm",children:"adr\t    x20, int32_var\nldr     x2, [x20]\n"})}),"\n",(0,d.jsxs)(s.p,{children:[(0,d.jsx)(s.code,{children:"adrp"})," + ",(0,d.jsx)(s.code,{children:"add"}),": shift by 4KB page(\xb14G, two instructions), the assembler will do:"]}),"\n",(0,d.jsxs)(s.ul,{children:["\n",(0,d.jsxs)(s.li,{children:["calculate the PC-relative offset from the current ",(0,d.jsx)(s.code,{children:"adr"})," instruction to the label ",(0,d.jsx)(s.code,{children:"int32_var"})," in page.","\n",(0,d.jsxs)(s.ul,{children:["\n",(0,d.jsx)(s.li,{children:"calculate the PC-relative offset in bytes."}),"\n",(0,d.jsx)(s.li,{children:"divide the byte offset using 4096(or right shift 12 bits), now the quotient is page offset"}),"\n"]}),"\n"]}),"\n",(0,d.jsxs)(s.li,{children:["encode the page offset in the ",(0,d.jsx)(s.code,{children:"adrp"})," instruction."]}),"\n",(0,d.jsxs)(s.li,{children:["encode the lower 12 bits in the ",(0,d.jsx)(s.code,{children:"add"})," instruction."]}),"\n"]}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-asm",children:"adrp\tx20, int32_var\nadd     x20, x20, :lo12:int32_var\nldr    x2, [x20]\n"})}),"\n",(0,d.jsx)(s.p,{children:"or more simply,"}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-asm",children:"adrp\tx20, int32_var\nldr    x2, [x20, :lo12:int32_var]\n"})}),"\n",(0,d.jsx)(s.p,{children:"in macOS m1,"}),"\n",(0,d.jsx)(s.pre,{children:(0,d.jsx)(s.code,{className:"language-asm",children:"adrp\tx20, int32_var@PAGE\nadd     x20, x20, int32_var@PAGEOFF\nldr    x2, [x20]\n"})}),"\n",(0,d.jsx)(s.h2,{id:"store",children:"Store"}),"\n",(0,d.jsx)(s.h2,{id:"resources",children:"Resources"}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.a,{href:"https://github.com/Siguza/ios-resources/blob/master/bits/arm64.md",children:"ios-resources/bits/arm64.md at master \xb7 Siguza/ios-resources \xb7 GitHub"})}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.a,{href:"https://github.com/pkivolowitz/asm_book/blob/main/section_1/regs/ldr.md",children:"asm_book/section_1/regs/ldr.md at main \xb7 pkivolowitz/asm_book \xb7 GitHub"})}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.a,{href:"https://thinkingeek.com/2016/11/13/exploring-aarch64-assembler-chapter-5/",children:"Exploring AArch64 assembler \u2013 Chapter 5"})}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.a,{href:"https://peterdn.com/post/2020/08/22/hello-world-in-arm64-assembly/",children:"https://peterdn.com/post/2020/08/22/hello-world-in-arm64-assembly/"})}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.a,{href:"https://gpanders.com/blog/exploring-mach-o-part-1/",children:"https://gpanders.com/blog/exploring-mach-o-part-1/"})}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.a,{href:"https://iitd-plos.github.io/col718/ref/arm-instructionset.pdf",children:"https://iitd-plos.github.io/col718/ref/arm-instructionset.pdf"})}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.a,{href:"https://modexp.wordpress.com/2018/10/30/arm64-assembly/#registers",children:"https://modexp.wordpress.com/2018/10/30/arm64-assembly/#registers"})}),"\n",(0,d.jsx)(s.p,{children:(0,d.jsx)(s.a,{href:"https://stackoverflow.com/questions/41906688/what-are-the-semantics-of-adrp-and-adrl-instructions-in-arm-assembly",children:"https://stackoverflow.com/questions/41906688/what-are-the-semantics-of-adrp-and-adrl-instructions-in-arm-assembly"})})]})}function o(e={}){const{wrapper:s}={...(0,n.R)(),...e.components};return s?(0,d.jsx)(s,{...e,children:(0,d.jsx)(a,{...e})}):a(e)}}}]);