"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[7359],{64901:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>i,default:()=>h,frontMatter:()=>c,metadata:()=>l,toc:()=>a});var s=r(74848),o=r(28453);const c={authors:["frank"],tags:["docker","docker compose","best practice","cheat sheet"],description:"Docker Useful Commands",keywords:["docker","docker compose","cheatsheet"],image:"https://i.imgur.com/mErPwqL.png",date:new Date("2023-08-11T00:00:00.000Z"),draft:!1,enableComments:!0},i="Docker Cheat Sheet",l={id:"cheatsheet-docker",title:"Docker Cheat Sheet",description:"Docker Useful Commands",source:"@site/../../docs/cheatsheet-docker.md",sourceDirName:".",slug:"/cheatsheet-docker",permalink:"/docs/cheatsheet-docker",draft:!1,unlisted:!1,editUrl:"https://github.com/liviaerxin/liviaerxin.github.io/edit/master/_ssg/docusaurus/../../docs/cheatsheet-docker.md",tags:[{inline:!0,label:"docker",permalink:"/docs/tags/docker"},{inline:!0,label:"docker compose",permalink:"/docs/tags/docker-compose"},{inline:!0,label:"best practice",permalink:"/docs/tags/best-practice"},{inline:!0,label:"cheat sheet",permalink:"/docs/tags/cheat-sheet"}],version:"current",lastUpdatedBy:"liviaerxin",lastUpdatedAt:1744661848e3,frontMatter:{authors:["frank"],tags:["docker","docker compose","best practice","cheat sheet"],description:"Docker Useful Commands",keywords:["docker","docker compose","cheatsheet"],image:"https://i.imgur.com/mErPwqL.png",date:"2023-08-11T00:00:00.000Z",draft:!1,enableComments:!0},sidebar:"docs",previous:{title:"x64 Assembly Cheat Sheet",permalink:"/docs/cheatsheet-assembly-x64"},next:{title:"Cheatsheet ImageMagick",permalink:"/docs/cheatsheet-imagemagick"}},d={},a=[{value:"Docker",id:"docker",level:2},{value:"Test image <code>busybox</code>",id:"test-image-busybox",level:3},{value:"Find the IP address of Docker container",id:"find-the-ip-address-of-docker-container",level:3},{value:"Delete all containers(include all status of running, stopped, created)",id:"delete-all-containersinclude-all-status-of-running-stopped-created",level:3},{value:"Delete the container by image name",id:"delete-the-container-by-image-name",level:3},{value:"Delete all volumes",id:"delete-all-volumes",level:3},{value:"Keep container running for for testing and debugging",id:"keep-container-running-for-for-testing-and-debugging",level:3},{value:"Docker Compose",id:"docker-compose",level:2},{value:"Check <code>docker-compose.yml</code> rendering",id:"check-docker-composeyml-rendering",level:3},{value:"Rebuild image and restart a service which you specified",id:"rebuild-image-and-restart-a-service-which-you-specified",level:3},{value:"Remove a service",id:"remove-a-service",level:3},{value:"<code>env_file</code> in <code>docker-compose.yml</code>",id:"env_file-in-docker-composeyml",level:3},{value:"Exclude sub folders when mounting a local folder",id:"exclude-sub-folders-when-mounting-a-local-folder",level:3},{value:"Dockerfile",id:"dockerfile",level:2},{value:"Download from GitHub release using wget",id:"download-from-github-release-using-wget",level:3},{value:"Download from GitHub release using curl",id:"download-from-github-release-using-curl",level:3}];function t(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"docker-cheat-sheet",children:"Docker Cheat Sheet"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["include ",(0,s.jsx)(n.code,{children:"docker"})," and ",(0,s.jsx)(n.code,{children:"docker compose"})," quick reference"]}),"\n",(0,s.jsx)(n.li,{children:"cover most useful commands"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"docker",children:"Docker"}),"\n",(0,s.jsxs)(n.h3,{id:"test-image-busybox",children:["Test image ",(0,s.jsx)(n.code,{children:"busybox"})]}),"\n",(0,s.jsxs)(n.p,{children:["Famous ",(0,s.jsx)(n.code,{children:"busybox"})," image that provide many common UNIX utilities for testing."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"docker run -it --rm --privileged busybox sh\n"})}),"\n",(0,s.jsx)(n.h3,{id:"find-the-ip-address-of-docker-container",children:"Find the IP address of Docker container"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"docker inspect \\\n    -f '{{range.NetworkSettings.Networks}}{{.IPAddress}}{{end}}' \\\n    nfs\n"})}),"\n",(0,s.jsx)(n.h3,{id:"delete-all-containersinclude-all-status-of-running-stopped-created",children:"Delete all containers(include all status of running, stopped, created)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"docker rm -f $(docker ps -a -q)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"delete-the-container-by-image-name",children:"Delete the container by image name"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"docker rm -f $(docker ps -a -q  --filter ancestor=<image name here!>)\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"drmi() { docker rm -f $(docker ps -a | awk -v i=\"^$1.*\" '{if($2~i){print$1}}'); }\n"})}),"\n",(0,s.jsx)(n.h3,{id:"delete-all-volumes",children:"Delete all volumes"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"docker volume rm $(docker volume ls -q)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"keep-container-running-for-for-testing-and-debugging",children:"Keep container running for for testing and debugging"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"# Use -t(-tty)\ndocker run --rm -d -t busybox\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"docker run --rm -d busybox tail -f /dev/null\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"docker run --rm -d busybox sleep infinity\n"})}),"\n",(0,s.jsx)(n.h2,{id:"docker-compose",children:"Docker Compose"}),"\n",(0,s.jsxs)(n.h3,{id:"check-docker-composeyml-rendering",children:["Check ",(0,s.jsx)(n.code,{children:"docker-compose.yml"})," rendering"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"docker compose --env-file .env --env-file .prod.env config\n"})}),"\n",(0,s.jsx)(n.h3,{id:"rebuild-image-and-restart-a-service-which-you-specified",children:"Rebuild image and restart a service which you specified"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"docker-compose up --no-deps web-app -d\n"})}),"\n",(0,s.jsx)(n.h3,{id:"remove-a-service",children:"Remove a service"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"docker-compose rm -s -v web-auth\n"})}),"\n",(0,s.jsxs)(n.h3,{id:"env_file-in-docker-composeyml",children:[(0,s.jsx)(n.code,{children:"env_file"})," in ",(0,s.jsx)(n.code,{children:"docker-compose.yml"})]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"env_file"})," equals ",(0,s.jsx)(n.code,{children:"environment"})," functions."]}),"\n",(0,s.jsxs)(n.li,{children:["If you use both the ",(0,s.jsx)(n.code,{children:"env_file"})," and ",(0,s.jsx)(n.code,{children:"environment"})," attribute, environment variables set by environment take precedence."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"env_file"})," not used for variables substitution in ",(0,s.jsx)(n.code,{children:"docker-compose.yml"})," file"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"env_file"})," is not the same as ",(0,s.jsx)(n.code,{children:"--env-file"})," used in ",(0,s.jsx)(n.code,{children:"docker-compose --env-file"})," cli.","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"--env-file .env.prod"})," will be used for interpolation for ",(0,s.jsx)(n.code,{children:"docker-compose.yml"})," file."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://forums.docker.com/t/variables-resolved-from-env-file-but-not-taking-effect-in-docker-compose-yaml/105394/2",children:"Variables resolved from env_file but not taking effect in docker-compose.yaml"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"docker compose --env-file .env --env-file .prod.env up -d\n"})}),"\n",(0,s.jsx)(n.h3,{id:"exclude-sub-folders-when-mounting-a-local-folder",children:"Exclude sub folders when mounting a local folder"}),"\n",(0,s.jsxs)(n.p,{children:["It's very useful when developing a node project. That will help only mount the local source codes while excluding the local ",(0,s.jsx)(n.code,{children:"node_modules"})," folder only in the container."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yml",children:'version: "3"\nservices:\n  node:\n    image: "node:16"\n    working_dir: /home/node/app\n    volumes:\n      - ./:/home/node/app\n      - /home/node/app/node_modules\n    expose:\n      - "8081"\n    command: "npm start"\n'})}),"\n",(0,s.jsx)(n.h2,{id:"dockerfile",children:"Dockerfile"}),"\n",(0,s.jsx)(n.h3,{id:"download-from-github-release-using-wget",children:"Download from GitHub release using wget"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"tgz"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dockerfile",children:'RUN GH_USER=REPLACE_WITH_USER \\\n    GH_REPO=REPLACE_WITH_REPO \\\n    GH_BRANCH=REPLACE_WITH_BRANCH \\\n    wget https://github.com/${GH_USER}/${GH_REPO}/archive/refs/tags/${GH_BRANCH}.tar.gz -O "${GH_REPO}-${GH_BRANCH}.tar.gz" \\\n    && tar -xzvf ./"${GH_REPO}-${GH_BRANCH}.tar.gz" \\\n    && rm ./"${GH_REPO}-${GH_BRANCH}.tar.gz"\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"zip"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-dockerfile",children:'RUN GH_USER=REPLACE_WITH_USER \\\n    GH_REPO=REPLACE_WITH_REPO \\\n    GH_BRANCH=REPLACE_WITH_BRANCH \\\n    wget https://github.com/${GH_USER}/${GH_REPO}/archive/refs/tags/${GH_BRANCH}.zip \\\n    -O "${GH_REPO}-${GH_BRANCH}.zip" && \\ \n    unzip ./"${GH_REPO}-${GH_BRANCH}.zip" && \\\n    rm ./"${GH_REPO}-${GH_BRANCH}.zip"\n'})}),"\n",(0,s.jsx)(n.h3,{id:"download-from-github-release-using-curl",children:"Download from GitHub release using curl"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"curl -L https://github.com/yarnpkg/yarn/releases/download/v0.23.4/ya\u200c\u200brn-v0.23.4.tar.gz > yarn.tar.gz\n"})})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(t,{...e})}):t(e)}},28453:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>l});var s=r(96540);const o={},c=s.createContext(o);function i(e){const n=s.useContext(c);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),s.createElement(c.Provider,{value:n},e.children)}}}]);